[Unit]
Description=Matrix Cloud Security Platform Agent
Documentation=https://github.com/mxsec-platform/mxsec-platform
After=network.target

[Service]
Type=simple
User=root
Group=root
ExecStart=/usr/bin/mxsec-agent
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal
SyslogIdentifier=mxsec-agent

# 安全设置
# 注意: 不使用 ProtectSystem/ProtectHome/PrivateTmp 等限制
# 因为 Agent 需要自更新能力，必须能写入 /usr/bin 等系统目录
# 参考 Elkeid 等成熟 Agent 的设计，以 root 权限运行的安全软件不需要这些限制
NoNewPrivileges=true

# 资源限制
LimitNOFILE=65536
LimitNPROC=4096
MemoryLimit=1G
CPUQuota=100%

# 环境变量
Environment="TZ=Asia/Shanghai"

[Install]
WantedBy=multi-user.target
