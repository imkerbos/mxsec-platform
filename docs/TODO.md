# Matrix Cloud Security Platform - TODO List

> æœ¬æ–‡æ¡£è®°å½•é¡¹ç›®çš„å¼€å‘ä»»åŠ¡å’Œè¿›åº¦ã€‚

---

## Phase 0: Elkeid ç ”ç©¶ä¸è®¾è®¡

### âœ… å·²å®Œæˆ

- [x] é˜…è¯» Elkeid ä»£ç ï¼Œç†è§£ Agent æ¶æ„
- [x] é˜…è¯» Elkeid Baseline æ’ä»¶ä»£ç ï¼Œç†è§£ç­–ç•¥æ¨¡å‹å’Œæ£€æŸ¥å¼•æ“
- [x] é˜…è¯» Elkeid Collector æ’ä»¶ä»£ç ï¼Œç†è§£èµ„äº§é‡‡é›†æœºåˆ¶
- [x] é˜…è¯» Elkeid æ’ä»¶ SDKï¼Œç†è§£ Pipe é€šä¿¡æœºåˆ¶
- [x] å®Œæˆ Elkeid æ¶æ„åˆ†ææ–‡æ¡£
- [x] è®¾è®¡æˆ‘ä»¬çš„ç­–ç•¥æ¨¡å‹ï¼ˆå‚è€ƒ Elkeidï¼Œä¼˜åŒ– OS åŒ¹é…ï¼‰
- [x] è®¾è®¡ Agent æ¶æ„ï¼ˆå®Œå…¨å‚è€ƒ Elkeidï¼Œé‡‡ç”¨æ’ä»¶æœºåˆ¶ï¼‰
- [x] è®¾è®¡ Server API æ¥å£ï¼ˆgRPC + HTTPï¼‰
- [x] è®¾è®¡æ•°æ®åº“æ¨¡å‹ï¼ˆhostsã€policiesã€rulesã€scan_resultsã€èµ„äº§è¡¨ç­‰ï¼‰

---

## Phase 1: MVPï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰

> **ç›®æ ‡**ï¼šå®ç°æœ€å°å¯ç”¨çš„ Agent + Server + Baseline Pluginï¼Œæ”¯æŒåŸºæœ¬çš„åŸºçº¿æ£€æŸ¥å’Œèµ„äº§é‡‡é›†ã€‚

### 1.0 åŸºç¡€è®¾æ–½

#### æ’ä»¶ SDK å¼€å‘
- [x] å®ç° Go æ’ä»¶ SDKï¼ˆ`plugins/lib/go/`ï¼‰
  - [x] `Client` ç»“æ„ä½“ï¼ˆPipe è¯»å†™å°è£…ï¼‰
  - [x] `SendRecord()` æ–¹æ³•ï¼ˆå‘é€æ•°æ®åˆ° Agentï¼‰
  - [x] `ReceiveTask()` æ–¹æ³•ï¼ˆæ¥æ”¶ Agent ä»»åŠ¡ï¼‰
  - [x] Protobuf åºåˆ—åŒ–/ååºåˆ—åŒ–
  - [x] é”™è¯¯å¤„ç†ä¸é‡è¯•

#### Protobuf å®šä¹‰
- [x] å®šä¹‰ `bridge.proto`ï¼ˆæ’ä»¶ â†” Agent é€šä¿¡åè®®ï¼‰
- [x] å®šä¹‰ `grpc.proto`ï¼ˆAgent â†” Server é€šä¿¡åè®®ï¼‰
- [x] ç”Ÿæˆ Go ä»£ç ï¼ˆprotocï¼‰
- [x] æ‰©å±• `grpc.proto` æ”¯æŒ AgentConfig å’Œ CertificateBundle

### 1.1 Agent å¼€å‘

#### åŸºç¡€æ¡†æ¶
- [x] Agent ä¸»ç¨‹åºå…¥å£ï¼ˆmain.goï¼‰
  - [x] é…ç½®åŠ è½½ï¼ˆå®Œå…¨ä¾èµ–æ„å»ºæ—¶åµŒå…¥ï¼Œæ— éœ€é…ç½®æ–‡ä»¶ï¼‰
  - [x] æ—¥å¿—åˆå§‹åŒ–ï¼ˆZapï¼ŒJSON è¾“å‡ºï¼ŒæŒ‰å¤©è½®è½¬ï¼Œä¿ç•™30å¤©ï¼‰
  - [x] Agent ID ç®¡ç†ï¼ˆä»æ–‡ä»¶è¯»å–æˆ–ç”Ÿæˆï¼‰
  - [x] ä¿¡å·å¤„ç†ï¼ˆSIGTERM, SIGINTï¼‰
  - [x] ä¼˜é›…é€€å‡º

#### è¿æ¥ç®¡ç†
- [x] æœåŠ¡å‘ç°ï¼ˆServiceDiscoveryï¼‰- ç®€åŒ–å®ç°ï¼Œç›´æ¥ä½¿ç”¨é…ç½®çš„ Server åœ°å€
- [x] mTLS é…ç½®ï¼ˆCAã€è¯ä¹¦ã€å¯†é’¥ï¼‰- è¯ä¹¦ç”± Server ä¸‹å‘
- [x] gRPC è¿æ¥å»ºç«‹ä¸ç®¡ç†
- [x] è¿æ¥é‡è¯•ä¸æ•…éšœè½¬ç§»

#### ä¼ è¾“æ¨¡å—
- [x] gRPC åŒå‘æµå®ç°
- [x] æ•°æ®æ‰“åŒ…ä¸å‘é€ï¼ˆPackagedDataï¼‰
- [x] å‘½ä»¤æ¥æ”¶ä¸å¤„ç†ï¼ˆCommandï¼‰
- [x] Agent é…ç½®æ›´æ–°å¤„ç†ï¼ˆAgentConfigï¼‰
- [x] è¯ä¹¦åŒ…æ›´æ–°å¤„ç†ï¼ˆCertificateBundleï¼‰
- [ ] snappy å‹ç¼©æ”¯æŒï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰
- [x] é”™è¯¯å¤„ç†ä¸é‡è¯•

#### å¿ƒè·³æ¨¡å—
- [x] å®šæ—¶å¿ƒè·³ï¼ˆé»˜è®¤ 60 ç§’ï¼Œå¯ç”± Server é…ç½®ï¼‰
- [x] Agent çŠ¶æ€é‡‡é›†ï¼ˆCPUã€å†…å­˜ã€å¯åŠ¨æ—¶é—´ï¼‰- åŸºç¡€å®ç°
- [x] ä¸»æœºä¿¡æ¯é‡‡é›†ï¼ˆOSã€å†…æ ¸ã€IPã€ä¸»æœºåï¼‰- å·²å®Œæˆï¼šè¯»å– /etc/os-releaseã€/proc/versionã€ç½‘ç»œæ¥å£
- [x] æ’ä»¶çŠ¶æ€é‡‡é›†ï¼ˆå·²å®Œæˆï¼šé€šè¿‡æ¥å£è·å–æ’ä»¶çŠ¶æ€ï¼ŒåŒ…å«åœ¨å¿ƒè·³æ•°æ®ä¸­ï¼‰
- [x] gRPC å¿ƒè·³ä¸ŠæŠ¥

#### æ’ä»¶ç®¡ç†
- [x] æ’ä»¶é…ç½®åŒæ­¥ï¼ˆä» Server æ¥æ”¶ï¼‰- å·²å®Œæˆï¼šé€šè¿‡ transport æ¨¡å—æ¥æ”¶é…ç½®
- [x] æ’ä»¶ç­¾åéªŒè¯ä¸ä¸‹è½½ - å·²å®Œæˆï¼šHTTP ä¸‹è½½ã€SHA256 æ ¡éªŒã€è‡ªåŠ¨é‡è¯•ã€å¯æ‰§è¡Œæƒé™è®¾ç½®
- [x] æ’ä»¶è¿›ç¨‹å¯åŠ¨ï¼ˆPipe åˆ›å»ºï¼‰- å·²å®Œæˆï¼šåˆ›å»º rx/tx ç®¡é“ï¼Œå¯åŠ¨å­è¿›ç¨‹
- [x] æ’ä»¶æ•°æ®æ¥æ”¶ï¼ˆä» Pipe è¯»å–ï¼‰- å·²å®Œæˆï¼šreceiveData goroutine å®ç°
- [x] æ’ä»¶ä»»åŠ¡å‘é€ï¼ˆå†™å…¥ Pipeï¼‰- å·²å®Œæˆï¼šä» transport æ¥æ”¶ä»»åŠ¡ï¼ŒæŒ‰æ’ä»¶åç§°åˆ†å‘ï¼Œåºåˆ—åŒ–å‘é€
- [x] æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆå¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€å‡çº§ï¼‰- å·²å®Œæˆï¼šloadPluginã€stopPluginã€SyncPlugins

#### Baseline Plugin
- [x] æ’ä»¶å…¥å£ï¼ˆmain.goï¼‰- å·²å®Œæˆï¼šä»»åŠ¡æ¥æ”¶ã€å¤„ç†ã€ç»“æœä¸ŠæŠ¥
- [x] æ’ä»¶ SDK é›†æˆï¼ˆplugins.Clientï¼‰- å·²å®Œæˆï¼šé€šè¿‡ Pipe ä¸ Agent é€šä¿¡
- [x] ç­–ç•¥åŠ è½½ä¸è§£æï¼ˆJSONï¼‰- å·²å®Œæˆï¼šæ”¯æŒ JSON æ ¼å¼çš„ç­–ç•¥é…ç½®
- [x] OS åŒ¹é…é€»è¾‘ - å·²å®Œæˆï¼šMatchOS æ–¹æ³•ï¼Œæ”¯æŒ os_family å’Œ os_version åŒ¹é…
- [x] è§„åˆ™æ‰§è¡Œæ¡†æ¶ - å·²å®Œæˆï¼šEngine.Executeã€executeRuleã€executeCheck
- [x] æ£€æŸ¥å™¨å®ç°ï¼š
  - [x] `file_kv`ï¼ˆé…ç½®æ–‡ä»¶é”®å€¼æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒå¤šç§é”®å€¼æ ¼å¼
  - [x] `file_line_match`ï¼ˆæ–‡ä»¶è¡ŒåŒ¹é…ï¼‰- å·²å®Œæˆï¼šæ”¯æŒæ­£åˆ™åŒ¹é…ã€åŒ¹é…/ä¸åŒ¹é…æ£€æŸ¥
  - [x] `file_permission`ï¼ˆæ–‡ä»¶æƒé™æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ 8 è¿›åˆ¶æƒé™æ¯”è¾ƒ
  - [x] `command_exec`ï¼ˆå‘½ä»¤æ‰§è¡Œï¼‰- å·²å®Œæˆï¼šæ”¯æŒå‘½ä»¤æ‰§è¡Œå’Œè¾“å‡ºåŒ¹é…
  - [x] `sysctl`ï¼ˆå†…æ ¸å‚æ•°æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ sysctl å‚æ•°å€¼æ£€æŸ¥å’Œæ­£åˆ™åŒ¹é…
  - [x] `service_status`ï¼ˆæœåŠ¡çŠ¶æ€æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ systemd/SysV æœåŠ¡çŠ¶æ€æ£€æŸ¥
  - [x] `file_owner`ï¼ˆæ–‡ä»¶å±ä¸»æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ uid:gid å’Œ username:groupname æ ¼å¼ï¼Œæ”¯æŒç”¨æˆ·å/ç»„åè§£æ
  - [x] `package_installed`ï¼ˆè½¯ä»¶åŒ…æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ RPM å’Œ DEB åŒ…ç®¡ç†å™¨ï¼Œæ”¯æŒç‰ˆæœ¬çº¦æŸï¼ˆ>=ã€<=ã€==ã€>ã€<ï¼‰
- [x] ç»“æœç”Ÿæˆä¸ä¸ŠæŠ¥ - å·²å®Œæˆï¼šç”Ÿæˆ Resultï¼Œé€šè¿‡ bridge.Record ä¸ŠæŠ¥

#### Baseline Plugin ç¤ºä¾‹è§„åˆ™
- [x] SSH é…ç½®æ£€æŸ¥ï¼ˆPermitRootLoginï¼‰- å·²å®Œæˆï¼šssh-baseline.jsonï¼ˆ3æ¡è§„åˆ™ï¼‰
- [x] å¯†ç ç­–ç•¥æ£€æŸ¥ï¼ˆPASS_MAX_DAYSï¼‰- å·²å®Œæˆï¼špassword-policy.jsonï¼ˆ2æ¡è§„åˆ™ï¼‰
- [x] æ–‡ä»¶æƒé™æ£€æŸ¥ï¼ˆ/etc/passwd, /etc/shadowï¼‰- å·²å®Œæˆï¼šfile-permissions.jsonï¼ˆ3æ¡è§„åˆ™ï¼‰
- [x] è‡³å°‘ 3 æ¡ç¤ºä¾‹è§„åˆ™ç”¨äºæµ‹è¯• - å·²å®Œæˆï¼šå…±5ä¸ªç­–ç•¥æ–‡ä»¶ï¼ŒåŒ…å«å¤šä¸ªè§„åˆ™
- [x] éªŒè¯å’Œå®Œå–„ç¤ºä¾‹è§„åˆ™ - å·²å®Œæˆï¼šéªŒè¯æ‰€æœ‰è§„åˆ™æ–‡ä»¶æ ¼å¼ã€è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯è§„åˆ™æ‰§è¡Œ

#### Collector Pluginï¼ˆPhase 1 å¯é€‰ï¼ŒPhase 2 å¿…é¡»ï¼‰
- [x] æ’ä»¶å…¥å£ï¼ˆmain.goï¼‰- å·²å®Œæˆï¼šmain.go å®ç°å®Œæ•´ï¼Œæ”¯æŒä»»åŠ¡æ¥æ”¶å’Œå®šæ—¶é‡‡é›†
- [x] æ’ä»¶ SDK é›†æˆï¼ˆplugins.Clientï¼‰- å·²å®Œæˆï¼šé€šè¿‡ Pipe ä¸ Agent é€šä¿¡
- [x] é‡‡é›†å¼•æ“ï¼ˆengineï¼‰- å·²å®Œæˆï¼šEngine å®ç°å®Œæ•´ï¼Œæ”¯æŒå®šæ—¶é‡‡é›†å’Œä»»åŠ¡è§¦å‘
- [x] åŸºç¡€é‡‡é›†å™¨å®ç°ï¼ˆPhase 1 MVPï¼‰ï¼š
  - [x] è¿›ç¨‹é‡‡é›†ï¼ˆProcessHandlerï¼‰- å·²å®Œæˆï¼šæ”¯æŒè¿›ç¨‹ä¿¡æ¯é‡‡é›†ã€MD5 è®¡ç®—ã€å®¹å™¨æ£€æµ‹
  - [x] ç«¯å£é‡‡é›†ï¼ˆPortHandlerï¼‰- å·²å®Œæˆï¼šæ”¯æŒ TCP/UDP ç«¯å£é‡‡é›†ã€è¿›ç¨‹å…³è”
  - [x] è´¦æˆ·é‡‡é›†ï¼ˆUserHandlerï¼‰- å·²å®Œæˆï¼šæ”¯æŒè´¦æˆ·ä¿¡æ¯é‡‡é›†ã€å¯†ç æ£€æµ‹
- [x] å®Œæ•´é‡‡é›†å™¨å®ç°ï¼ˆPhase 2ï¼‰ï¼š
  - [x] è½¯ä»¶åŒ…é‡‡é›†ï¼ˆSoftwareHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
  - [x] å®¹å™¨é‡‡é›†ï¼ˆContainerHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
  - [x] åº”ç”¨é‡‡é›†ï¼ˆAppHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
  - [x] ç¡¬ä»¶é‡‡é›†ï¼ˆNetInterfaceHandler, VolumeHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
  - [x] å†…æ ¸æ¨¡å—é‡‡é›†ï¼ˆKmodHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
  - [x] ç³»ç»ŸæœåŠ¡é‡‡é›†ï¼ˆServiceHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
  - [x] å®šæ—¶ä»»åŠ¡é‡‡é›†ï¼ˆCronHandlerï¼‰- å·²å®Œæˆï¼šä»£ç å·²å®ç°ï¼Œä½† Server ç«¯æš‚ä¸å­˜å‚¨ï¼ˆPhase 2.3ï¼‰
- [x] èµ„äº§æ•°æ®ä¸ŠæŠ¥ - å·²å®Œæˆï¼šé€šè¿‡ bridge.Record ä¸ŠæŠ¥ï¼Œæ”¯æŒæ‰€æœ‰èµ„äº§ç±»å‹ï¼ˆ5050-5060ï¼‰

### 1.2 Server å¼€å‘

> **å½“å‰é˜¶æ®µé‡ç‚¹**ï¼šå®ç° Server ç«¯æ ¸å¿ƒåŠŸèƒ½ï¼Œæ”¯æŒ Agent è¿æ¥å’Œæ•°æ®æ¥æ”¶ã€‚

#### 1.2.1 æ•°æ®åº“æ¨¡å‹ï¼ˆ**ä¼˜å…ˆå®ç°**ï¼‰âœ…
- [x] å®šä¹‰æ•°æ®åº“æ¨¡å‹ï¼ˆGormï¼‰
  - [x] `hosts` è¡¨ï¼ˆä¸»æœºä¿¡æ¯ï¼šhost_idã€hostnameã€os_familyã€os_versionã€kernel_versionã€archã€ipv4ã€statusã€last_heartbeat ç­‰ï¼‰
  - [x] `policies` è¡¨ï¼ˆç­–ç•¥é›†ï¼špolicy_idã€nameã€descriptionã€os_familyã€os_versionã€enabledã€created_at ç­‰ï¼‰
  - [x] `rules` è¡¨ï¼ˆè§„åˆ™ï¼šrule_idã€policy_idã€categoryã€titleã€descriptionã€severityã€check_typeã€check_paramã€fix_suggestion ç­‰ï¼‰
  - [x] `scan_results` è¡¨ï¼ˆæ£€æµ‹ç»“æœï¼šidã€host_idã€rule_idã€task_idã€statusã€actualã€expectedã€checked_at ç­‰ï¼‰
  - [x] `scan_tasks` è¡¨ï¼ˆæ‰«æä»»åŠ¡ï¼štask_idã€policy_idã€target_hostsã€statusã€created_atã€executed_at ç­‰ï¼‰
  - [x] èµ„äº§è¡¨ï¼ˆprocessesã€portsã€asset_usersï¼‰- å·²å®Œæˆï¼šProcessã€Portã€AssetUser æ¨¡å‹å·²å®šä¹‰å¹¶æ³¨å†Œåˆ° AllModelsï¼Œæ•°æ®åº“è¿ç§»ä¼šè‡ªåŠ¨åˆ›å»ºè¿™äº›è¡¨
- [x] ç¼–å†™æ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆGorm AutoMigrateï¼‰
- [x] åˆ›å»ºåˆå§‹åŒ–æ•°æ®ï¼ˆé»˜è®¤ç­–ç•¥ã€ç¤ºä¾‹è§„åˆ™ï¼‰

#### 1.2.2 AgentCenterï¼ˆgRPC Serverï¼‰
- [x] AgentCenter ä¸»ç¨‹åºå…¥å£ï¼ˆ`cmd/server/agentcenter/main.go`ï¼‰
- [x] é…ç½®åŠ è½½ï¼ˆViper + YAMLï¼Œ`configs/server.yaml.example`ï¼‰
- [x] æ—¥å¿—åˆå§‹åŒ–ï¼ˆZapï¼ŒJSON è¾“å‡ºï¼‰
- [x] gRPC Server å¯åŠ¨ï¼ˆç›‘å¬ç«¯å£ï¼Œé»˜è®¤ 6751ï¼‰
- [x] mTLS é…ç½®ï¼ˆCAã€è¯ä¹¦ã€å¯†é’¥ï¼‰- æ”¯æŒè¯ä¹¦ç”Ÿæˆè„šæœ¬
- [x] æ•°æ®åº“è¿æ¥ï¼ˆGorm + MySQL/PostgreSQLï¼‰
- [x] `Transfer` æœåŠ¡å®ç°ï¼ˆåŒå‘æµï¼‰
  - [x] æ¥æ”¶ Agent æ•°æ®æµï¼ˆ`stream PackagedData`ï¼‰
  - [x] å‘é€å‘½ä»¤æµï¼ˆ`stream Command`ï¼‰
- [x] æ¥æ”¶ Agent æ•°æ®ï¼ˆå¿ƒè·³ã€æ£€æµ‹ç»“æœã€èµ„äº§æ•°æ®ï¼‰
  - [x] è§£æ `PackagedData` å’Œ `EncodedRecord`
  - [x] æ ¹æ® `data_type` è·¯ç”±åˆ°ä¸åŒå¤„ç†å™¨
  - [x] DataType=1000ï¼šå¿ƒè·³æ•°æ® â†’ æ›´æ–° `hosts` è¡¨
  - [x] DataType=8000ï¼šåŸºçº¿æ£€æŸ¥ç»“æœ â†’ æ’å…¥ `scan_results` è¡¨
  - [x] DataType=5050-5064ï¼šèµ„äº§æ•°æ® â†’ æ’å…¥å¯¹åº”èµ„äº§è¡¨ï¼ˆPhase 2ï¼‰- å·²å®Œæˆï¼šåŸºç¡€ä¸‰ç§ç±»å‹ï¼ˆè¿›ç¨‹ã€ç«¯å£ã€è´¦æˆ·ï¼‰å·²å®ç°å­˜å‚¨ï¼Œå…¶ä»–ç±»å‹æš‚è®°å½•æ—¥å¿—ï¼ˆPhase 2.3ï¼‰
  - [x] å­˜å‚¨åˆ°æ•°æ®åº“
- [x] ä¸‹å‘ä»»åŠ¡å’Œé…ç½®åˆ° Agent
  - [x] æŸ¥è¯¢ `scan_tasks` è¡¨ï¼Œè·å–å¾…æ‰§è¡Œä»»åŠ¡
  - [x] å°è£…ä¸º `Command` å¹¶å‘é€åˆ° Agent
  - [ ] æ’ä»¶é…ç½®æ›´æ–°ï¼ˆConfigï¼‰ä¸‹å‘ï¼ˆå¯é€‰ï¼Œåç»­å®ç°ï¼‰
- [x] mTLS åŒå‘è®¤è¯ï¼ˆéªŒè¯ Agent è¯ä¹¦ï¼‰
- [x] è¿æ¥çŠ¶æ€ç®¡ç†ï¼ˆMap[agent_id]*Connectionï¼‰
- [x] è¿æ¥æ–­å¼€å¤„ç†ï¼ˆæ¸…ç†è¿æ¥çŠ¶æ€ï¼‰

#### 1.2.3 Managerï¼ˆHTTP API Serverï¼‰
- [x] Manager ä¸»ç¨‹åºå…¥å£ï¼ˆ`cmd/server/manager/main.go`ï¼‰
- [x] é…ç½®åŠ è½½ï¼ˆViper + YAMLï¼‰
- [x] æ—¥å¿—åˆå§‹åŒ–ï¼ˆZapï¼ŒJSON è¾“å‡ºï¼‰
- [x] HTTP Serverï¼ˆGinï¼Œé»˜è®¤ç«¯å£ 8080ï¼‰
- [x] æ•°æ®åº“è¿æ¥ï¼ˆGorm + MySQL/PostgreSQLï¼‰
- [x] ä¸­é—´ä»¶ï¼ˆCORSã€æ—¥å¿—ã€Recoveryï¼‰

#### Managerï¼ˆHTTP APIï¼‰
- [x] `GET /api/v1/hosts`ï¼šè·å–ä¸»æœºåˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€è¿‡æ»¤ï¼‰
- [x] `GET /api/v1/hosts/{host_id}`ï¼šè·å–ä¸»æœºè¯¦æƒ…ï¼ˆåŒ…å«åŸºçº¿ç»“æœå’Œæœ€æ–°ç›‘æ§æ•°æ®ï¼‰
- [x] `GET /api/v1/hosts/{host_id}/metrics`ï¼šè·å–ä¸»æœºç›‘æ§æ•°æ®ï¼ˆæ”¯æŒ MySQL å’Œ Prometheus æŸ¥è¯¢ï¼‰
- [x] `GET /api/v1/policies`ï¼šè·å–ç­–ç•¥åˆ—è¡¨
- [x] `POST /api/v1/policies`ï¼šåˆ›å»ºç­–ç•¥
- [x] `PUT /api/v1/policies/{policy_id}`ï¼šæ›´æ–°ç­–ç•¥
- [x] `DELETE /api/v1/policies/{policy_id}`ï¼šåˆ é™¤ç­–ç•¥
- [x] `GET /api/v1/policies/{policy_id}/statistics`ï¼šè·å–ç­–ç•¥ç»Ÿè®¡ä¿¡æ¯ï¼ˆé€šè¿‡ç‡ã€ä¸»æœºæ•°ã€æ£€æŸ¥é¡¹æ•°ç­‰ï¼‰- å·²å®Œæˆï¼šè¿”å›é€šè¿‡ç‡ã€ä¸»æœºæ•°ã€æ£€æŸ¥é¡¹æ•°ã€é£é™©é¡¹æ•°ã€æœ€è¿‘æ£€æŸ¥æ—¶é—´ç­‰ç»Ÿè®¡ä¿¡æ¯
- [x] `POST /api/v1/tasks`ï¼šåˆ›å»ºæ‰«æä»»åŠ¡
- [x] `GET /api/v1/tasks`ï¼šè·å–ä»»åŠ¡åˆ—è¡¨
- [x] `POST /api/v1/tasks/{task_id}/run`ï¼šæ‰§è¡Œä»»åŠ¡
- [x] `GET /api/v1/results`ï¼šè·å–æ£€æµ‹ç»“æœï¼ˆæ”¯æŒæŒ‰ä¸»æœºã€æŒ‰è§„åˆ™ã€æŒ‰ç­–ç•¥è¿‡æ»¤ï¼‰
- [x] `GET /api/v1/results/host/{host_id}/score`ï¼šè·å–ä¸»æœºåŸºçº¿å¾—åˆ†
- [x] `GET /api/v1/results/host/{host_id}/summary`ï¼šè·å–ä¸»æœºåŸºçº¿æ‘˜è¦
- [x] `POST /api/v1/auth/login`ï¼šç”¨æˆ·ç™»å½•
- [x] `POST /api/v1/auth/logout`ï¼šç”¨æˆ·ç™»å‡º
- [x] `GET /api/v1/auth/me`ï¼šè·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- [x] `GET /api/v1/dashboard/stats`ï¼šè·å– Dashboard ç»Ÿè®¡æ•°æ®
- [x] `GET /api/v1/assets/*`ï¼šè·å–èµ„äº§æ•°æ®ï¼ˆPhase 2ï¼‰- å·²å®Œæˆï¼š`/api/v1/assets/processes`ã€`/api/v1/assets/ports`ã€`/api/v1/assets/users` å·²å®ç°

#### Manager ä¸šåŠ¡é€»è¾‘
- [x] ä¸»æœºæ³¨å†Œä¸æ›´æ–°ï¼ˆåŸºäºå¿ƒè·³æ•°æ®è‡ªåŠ¨æ³¨å†Œ/æ›´æ–°ï¼‰- å·²åœ¨ AgentCenter å®ç°
- [x] ç­–ç•¥åŒ¹é…ï¼ˆæ ¹æ® OS ä¿¡æ¯åŒ¹é…é€‚ç”¨çš„ç­–ç•¥å’Œè§„åˆ™ï¼‰- å·²åœ¨ AgentCenter å®ç°åŸºç¡€æœåŠ¡
- [x] æ£€æµ‹ç»“æœå­˜å‚¨ä¸æŸ¥è¯¢ï¼ˆèšåˆã€ç»Ÿè®¡ï¼‰- å·²åœ¨ AgentCenter å®ç°å­˜å‚¨
- [x] æ‰«æä»»åŠ¡ç®¡ç†ï¼ˆåˆ›å»ºã€æ‰§è¡Œã€æŸ¥è¯¢ã€çŠ¶æ€æ›´æ–°ï¼‰- å·²å®Œæˆ
- [x] åŸºçº¿å¾—åˆ†è®¡ç®—å’Œç¼“å­˜æœºåˆ¶ - å·²å®Œæˆ
- [x] ä»»åŠ¡çŠ¶æ€è‡ªåŠ¨æ›´æ–°æœºåˆ¶ - å·²å®Œæˆ
- [x] é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘ - å·²å®Œæˆ
- [x] èµ„äº§æ•°æ®æŸ¥è¯¢ï¼ˆæŒ‰ä¸»æœºã€æŒ‰ç±»å‹ï¼‰- Phase 2 - å·²å®Œæˆï¼šåŸºç¡€ä¸‰ç§ç±»å‹ï¼ˆè¿›ç¨‹ã€ç«¯å£ã€è´¦æˆ·ï¼‰å·²å®ç°æŸ¥è¯¢ API

#### ServiceDiscoveryï¼ˆæœåŠ¡å‘ç°ï¼‰- **å¯é€‰ï¼ŒPhase 1 å¯ç®€åŒ–**
- [ ] ServiceDiscovery ä¸»ç¨‹åºå…¥å£
- [ ] æœåŠ¡æ³¨å†Œæ¥å£ï¼ˆgRPC æœåŠ¡æ³¨å†Œï¼‰
- [ ] æœåŠ¡å‘ç°æ¥å£ï¼ˆHTTP APIï¼Œä¾› Agent æŸ¥è¯¢ï¼‰
- [ ] æœåŠ¡å¥åº·æ£€æŸ¥
- [ ] æœåŠ¡åˆ—è¡¨ç®¡ç†
- [ ] **æ³¨æ„**ï¼šPhase 1 å¯ä»¥ç®€åŒ–å®ç°ï¼ŒAgent ç›´æ¥ä½¿ç”¨é…ç½®çš„ Server åœ°å€

### 1.3 éƒ¨ç½²ä¸æµ‹è¯•

#### æ‰“åŒ…ä¸éƒ¨ç½²
- [x] Agent æ„å»ºè„šæœ¬ï¼ˆæ”¯æŒæ„å»ºæ—¶åµŒå…¥ Server åœ°å€ï¼‰
- [x] Agent å®‰è£…è„šæœ¬ï¼ˆä¸€é”®å®‰è£…ï¼Œè‡ªåŠ¨ä¸‹è½½å¯¹åº”æ¶æ„çš„å®‰è£…åŒ…ï¼‰
- [x] Agent æ‰“åŒ…è„šæœ¬ï¼ˆRPM/DEBï¼Œä½¿ç”¨ nFPMï¼‰- å·²å®Œæˆï¼š`scripts/package-agent.sh`
- [ ] Baseline Plugin æ‰“åŒ…è„šæœ¬ - å¯é€‰ï¼Œåç»­å®ç°
- [ ] Collector Plugin æ‰“åŒ…è„šæœ¬ï¼ˆå¯é€‰ï¼ŒPhase 2ï¼‰
- [x] systemd service æ–‡ä»¶ - å·²å®Œæˆï¼š`deploy/systemd/`ï¼ˆAgentã€AgentCenterã€Managerï¼‰
- [x] Server Docker Compose é…ç½® - å·²å®Œæˆï¼š`deploy/docker-compose/`
- [x] è¯ä¹¦ç”Ÿæˆè„šæœ¬ï¼ˆmTLSï¼‰- Server ç«¯å®ç°ï¼ˆ`scripts/generate-certs.sh`ï¼‰

#### æµ‹è¯•
- [x] Agent å•å…ƒæµ‹è¯•ï¼ˆé…ç½®ã€æ—¥å¿—ã€ID ç®¡ç†ï¼‰- å·²å®ŒæˆåŸºç¡€æµ‹è¯•
- [x] æ’ä»¶ç®¡ç†å•å…ƒæµ‹è¯• - å·²å®ŒæˆåŸºç¡€æµ‹è¯•
- [x] Baseline Plugin å•å…ƒæµ‹è¯•ï¼ˆæ£€æŸ¥å™¨ï¼‰- å·²å®Œæˆï¼šæ‰€æœ‰æ£€æŸ¥å™¨ï¼ˆfile_kvã€file_permissionã€file_line_matchã€command_execã€sysctlã€service_statusã€file_ownerã€package_installedï¼‰æµ‹è¯•é€šè¿‡
- [x] Manager API é›†æˆæµ‹è¯• - å·²å®Œæˆï¼ˆpoliciesã€tasksã€results API æµ‹è¯•ï¼‰
- [ ] Server å•å…ƒæµ‹è¯•ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰- éƒ¨åˆ†å®Œæˆ
- [x] ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆAgent + Server + Plugin å®Œæ•´æµç¨‹ï¼‰- å·²å®Œæˆï¼šåŒ…æ‹¬åŸºçº¿æ£€æŸ¥æµç¨‹å’Œèµ„äº§é‡‡é›†æµç¨‹ï¼ˆè¿›ç¨‹ã€ç«¯å£ã€è´¦æˆ·ï¼‰

#### æ–‡æ¡£
- [x] Agent éƒ¨ç½²æ–‡æ¡£ï¼ˆä¸€é”®å®‰è£…ã€æ‰‹åŠ¨å®‰è£…ã€æºç ç¼–è¯‘ï¼‰
- [x] Agent é…ç½®è®¾è®¡æ–‡æ¡£ï¼ˆæ„å»ºæ—¶åµŒå…¥ã€æ—¥å¿—é…ç½®ï¼‰
- [x] Server éƒ¨ç½²æ–‡æ¡£ - å·²å®Œæˆï¼š`docs/deployment/server-deployment.md`
- [x] Server é…ç½®æ–‡æ¡£ - å·²å®Œæˆï¼š`docs/deployment/server-config.md`
- [x] å¼€å‘æ–‡æ¡£ï¼ˆå¦‚ä½•å¼€å‘æ’ä»¶ã€å¦‚ä½•æ‰©å±•æ£€æŸ¥å™¨ï¼‰- å·²å®Œæˆï¼š`docs/development/plugin-development.md`

---

## Phase 2: åŠŸèƒ½å®Œå–„

### 2.1 Agent å¢å¼º

- [x] æ’ä»¶çƒ­æ›´æ–°æœºåˆ¶ - å·²å®Œæˆï¼šå¹³æ»‘åˆ‡æ¢ã€å›æ»šæœºåˆ¶ã€ç‰ˆæœ¬æ£€æµ‹
- [x] æ’ä»¶ç‰ˆæœ¬ç®¡ç† - å·²å®Œæˆï¼šè¯­ä¹‰åŒ–ç‰ˆæœ¬æ¯”è¾ƒã€ç‰ˆæœ¬è§£æã€ç‰ˆæœ¬å†å²è®°å½•
- [x] æ›´å¤šæ£€æŸ¥å™¨å®ç°ï¼š
  - [x] `sysctl`ï¼ˆå†…æ ¸å‚æ•°æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼ˆæå‰å®ç°ï¼‰
  - [x] `service_status`ï¼ˆæœåŠ¡çŠ¶æ€æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼ˆæå‰å®ç°ï¼‰
  - [x] `file_owner`ï¼ˆæ–‡ä»¶å±ä¸»æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ uid:gid å’Œ username:groupname æ ¼å¼ï¼Œæ”¯æŒç”¨æˆ·å/ç»„åè§£æ
  - [x] `package_installed`ï¼ˆè½¯ä»¶åŒ…æ£€æŸ¥ï¼‰- å·²å®Œæˆï¼šæ”¯æŒ RPM å’Œ DEB åŒ…ç®¡ç†å™¨ï¼Œæ”¯æŒç‰ˆæœ¬çº¦æŸï¼ˆ>=ã€<=ã€==ã€>ã€<ï¼‰
- [x] æ£€æŸ¥ç»“æœæœ¬åœ°ç¼“å­˜ï¼ˆæ–­ç½‘æ—¶æš‚å­˜ï¼‰- å·²å®Œæˆï¼šæœ¬åœ°æ–‡ä»¶ç¼“å­˜ã€è‡ªåŠ¨é‡è¯•ã€ç¼“å­˜æ¸…ç†ç­–ç•¥
- [x] èµ„æºç›‘æ§ä¸ä¸ŠæŠ¥ - å·²å®Œæˆï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œæŒ‡æ ‡é‡‡é›†å’Œä¸ŠæŠ¥
- [ ] å®Œæ•´èµ„äº§é‡‡é›†ï¼ˆæ‰€æœ‰ç±»å‹ï¼‰- Collector Plugin å·²å®ç°åŸºç¡€é‡‡é›†å™¨ï¼Œå®Œæ•´ç‰ˆå¾…å®ç°

### 2.2 Server å¢å¼º

- [x] ç­–ç•¥ç®¡ç† APIï¼ˆCRUDï¼‰- å·²å®Œæˆ
- [x] ä¸»æœºç®¡ç† APIï¼ˆåˆ—è¡¨ã€è¯¦æƒ…ï¼‰- å·²å®Œæˆ
- [x] æ£€æµ‹ç»“æœæŸ¥è¯¢ APIï¼ˆæŒ‰ä¸»æœºã€æŒ‰è§„åˆ™ã€æŒ‰ç­–ç•¥ï¼‰- å·²å®Œæˆ
- [x] æ‰«æä»»åŠ¡ç®¡ç† APIï¼ˆåˆ›å»ºã€æ‰§è¡Œã€æŸ¥è¯¢ï¼‰- å·²å®Œæˆ
- [x] ç»Ÿè®¡ä¸èšåˆï¼ˆåŸºçº¿å¾—åˆ†ã€é€šè¿‡ç‡ç­‰ï¼‰- å·²å®Œæˆ
- [x] ç›‘æ§æ•°æ®æŸ¥è¯¢ APIï¼ˆMySQL å’Œ Prometheus æ··åˆæŸ¥è¯¢ï¼‰- å·²å®Œæˆ
  - [x] Prometheus æŸ¥è¯¢å®¢æˆ·ç«¯å®ç°
  - [x] MySQL å…³è”æŸ¥è¯¢ç›‘æ§æ•°æ®ï¼ˆGetHost APIï¼‰
  - [x] Prometheus + MySQL æ··åˆæŸ¥è¯¢æœåŠ¡
  - [x] GET /api/v1/hosts/:host_id/metrics API ç«¯ç‚¹

### 2.3 å‰ç«¯ UI âœ…

- [x] ä¸»æœºåˆ—è¡¨é¡µé¢ - å·²å®Œæˆï¼šæ”¯æŒç­›é€‰ã€åŸºçº¿å¾—åˆ†å±•ç¤ºã€åˆ†é¡µ
- [x] ä¸»æœºè¯¦æƒ…é¡µé¢ï¼ˆåŸºçº¿å¾—åˆ†ã€è§„åˆ™åˆ—è¡¨ï¼‰- å·²å®Œæˆï¼šåŸºæœ¬ä¿¡æ¯ã€åŸºçº¿å¾—åˆ†ã€æ£€æŸ¥ç»“æœåˆ—è¡¨ã€æ€§èƒ½ç›‘æ§æ•°æ®å±•ç¤º
- [x] ç­–ç•¥ç®¡ç†é¡µé¢ï¼ˆç­–ç•¥åˆ—è¡¨ã€è§„åˆ™ç¼–è¾‘ï¼‰- å·²å®Œæˆï¼šåˆ—è¡¨ã€åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ã€å¯ç”¨/ç¦ç”¨
- [x] ç­–ç•¥è¯¦æƒ…é¡µé¢ï¼ˆåŸºçº¿æ£€æŸ¥è¯¦æƒ…ï¼‰- å·²å®Œæˆï¼šæ£€æŸ¥æ¦‚è§ˆï¼ˆé€šè¿‡ç‡ã€ä¸»æœºæ•°ã€æ£€æŸ¥é¡¹æ•°ï¼‰ã€æ£€æŸ¥é¡¹è§†è§’ï¼ˆè§„åˆ™åˆ—è¡¨å’Œè¯¦æƒ…ï¼‰ã€å½±å“çš„ä¸»æœºåˆ—è¡¨ã€ç­–ç•¥ç»Ÿè®¡ API é›†æˆ
- [x] æ‰«æä»»åŠ¡ç®¡ç†é¡µé¢ - å·²å®Œæˆï¼šåˆ—è¡¨ã€åˆ›å»ºã€æ‰§è¡Œä»»åŠ¡
- [x] èµ„äº§æ•°æ®å±•ç¤º - å·²å®Œæˆï¼šèµ„äº§æŒ‡çº¹ç»Ÿè®¡å±•ç¤ºã€è¿›ç¨‹åˆ—è¡¨ã€ç«¯å£åˆ—è¡¨ã€ç”¨æˆ·åˆ—è¡¨
- [x] Dashboard é¡µé¢ - å·²å®Œæˆï¼šç»Ÿè®¡æ¦‚è§ˆã€ä¸»æœºçŠ¶æ€åˆ†å¸ƒã€ä¸»æœºé£é™©åˆ†å¸ƒã€åŸºçº¿é£é™© Top 3
- [x] å‰ç«¯ API é›†æˆ - å·²å®Œæˆï¼šä¸»æœºç›‘æ§æ•°æ® APIã€ä¸»æœºçŠ¶æ€/é£é™©åˆ†å¸ƒ APIã€ç­–ç•¥ç»Ÿè®¡ä¿¡æ¯ API
- [x] å‰ç«¯ API æµ‹è¯•å’ŒéªŒè¯ - å·²å®Œæˆï¼šæµ‹è¯•è„šæœ¬ã€æµ‹è¯•æ–‡æ¡£ã€ä»£ç è´¨é‡æ£€æŸ¥
- [x] ç”¨æˆ·ä½“éªŒæ”¹è¿› - å·²å®Œæˆï¼šå…¨å±€é”™è¯¯æç¤ºã€æ“ä½œæˆåŠŸæç¤ºã€æ”¹è¿› API é”™è¯¯å¤„ç†
- [x] å¼€å‘æ–‡æ¡£å®Œå–„ - å·²å®Œæˆï¼šå¿«é€Ÿå¼€å§‹æŒ‡å—ã€å¼€å‘æŒ‡å—ã€æ•…éšœæ’æŸ¥æŒ‡å—
- [x] ç»Ÿè®¡æŠ¥è¡¨é¡µé¢ - å·²å®Œæˆï¼šå‰ç«¯é¡µé¢å’Œåç«¯ API å‡å·²å®ç°ï¼ŒåŒ…å«å®Œæ•´çš„æŠ¥è¡¨ç»Ÿè®¡ã€åŸºçº¿å¾—åˆ†è¶‹åŠ¿å’Œæ£€æŸ¥ç»“æœè¶‹åŠ¿åŠŸèƒ½
- [x] å­—æ®µçŠ¶æ€æ˜¾ç¤ºåŠŸèƒ½ - å·²å®Œæˆï¼šåŒºåˆ†"æœ‰å€¼"ã€"æœªé‡‡é›†"ã€"æ— æ•°æ®"çŠ¶æ€ï¼Œæ”¯æŒç¡¬ä»¶ä¿¡æ¯ã€æ—¶é—´å­—æ®µã€IPåœ°å€å­—æ®µçš„ç‰¹æ®Šå¤„ç†
- [x] ç³»ç»Ÿé…ç½®ç®¡ç† - å·²å®Œæˆï¼šç«™ç‚¹é…ç½®ã€Logoä¸Šä¼ ã€Kubernetesé•œåƒé…ç½®ã€ç³»ç»Ÿé…ç½® API è·¯ç”±
- [x] å‘Šè­¦ç®¡ç†æ¨¡å— - å·²å®Œæˆï¼šå‘Šè­¦åˆ—è¡¨é¡µé¢ã€å‘Šè­¦è¯¦æƒ…ã€å‘Šè­¦æ•°æ®æ¨¡å‹å’Œ API
- [x] ä¸šåŠ¡çº¿ç®¡ç†æ¨¡å— - å·²å®Œæˆï¼šä¸šåŠ¡çº¿åˆ—è¡¨é¡µé¢ã€ä¸šåŠ¡çº¿è¯¦æƒ…ã€ä¸šåŠ¡çº¿æ•°æ®æ¨¡å‹å’Œ API
- [x] é€šçŸ¥ç®¡ç†æ¨¡å— - å·²å®Œæˆï¼šé€šçŸ¥åˆ—è¡¨é¡µé¢ã€é€šçŸ¥è¯¦æƒ…ã€é€šçŸ¥æ•°æ®æ¨¡å‹å’Œ API
- [x] é¡¹ç›®ç»“æ„ä¼˜åŒ– - å·²å®Œæˆï¼šæ¸…ç†è¿‡æ—¶æ–‡æ¡£å’Œè„šæœ¬ï¼Œä¼˜åŒ–é¡¹ç›®ç»“æ„

---

## Phase 3: æ‰©å±•åŠŸèƒ½

### 3.1 ä¸­é—´ä»¶åŸºçº¿

- [ ] Nginx åŸºçº¿æ£€æŸ¥
- [ ] Redis åŸºçº¿æ£€æŸ¥
- [ ] MySQL åŸºçº¿æ£€æŸ¥
- [ ] å…¶ä»–ä¸­é—´ä»¶åŸºçº¿

### 3.2 é«˜çº§ç‰¹æ€§

- [ ] ç­–ç•¥ç‰ˆæœ¬ç®¡ç†
- [ ] è§„åˆ™ä¾èµ–å…³ç³»
- [ ] è‡ªå®šä¹‰æ£€æŸ¥å™¨ï¼ˆè„šæœ¬/æ’ä»¶ï¼‰
- [ ] æ’ä»¶å¸‚åœºï¼ˆç¬¬ä¸‰æ–¹æ’ä»¶æ”¯æŒï¼‰
- [ ] æ’ä»¶æƒé™æ§åˆ¶

### 3.3 é›†æˆä¸å¯¹æ¥

- [x] Prometheus æŒ‡æ ‡å¯¼å‡º - å·²å®Œæˆï¼šPrometheus æŸ¥è¯¢å®¢æˆ·ç«¯å’Œæ··åˆæŸ¥è¯¢æœåŠ¡
- [ ] å‘Šè­¦å¯¹æ¥ï¼ˆWebhookã€Larkã€é‚®ä»¶ç­‰ï¼‰
- [ ] CMDB é›†æˆ
- [ ] æ—¥å¿—ç³»ç»Ÿé›†æˆï¼ˆELK/Lokiï¼‰

---

## å½“å‰ä»»åŠ¡

**å½“å‰é˜¶æ®µ**ï¼šPhase 1 MVP åŸºæœ¬å®Œæˆ âœ…ï¼Œè¿›å…¥ Phase 2 åŠŸèƒ½å®Œå–„é˜¶æ®µ

**å·²å®Œæˆ**ï¼š
1. âœ… Phase 0ï¼šElkeid ç ”ç©¶ã€æ¶æ„è®¾è®¡ã€API è®¾è®¡ã€æ•°æ®åº“è®¾è®¡
2. âœ… Phase 1.0ï¼šåŸºç¡€è®¾æ–½ï¼ˆæ’ä»¶ SDKã€Protobuf å®šä¹‰ã€ä»£ç ç”Ÿæˆï¼‰
3. âœ… Phase 1.1 åŸºç¡€æ¡†æ¶ï¼šAgent ä¸»ç¨‹åºã€é…ç½®ç®¡ç†ã€æ—¥å¿—ç³»ç»Ÿã€Agent ID ç®¡ç†
4. âœ… Phase 1.1 è¿æ¥ç®¡ç†ï¼šmTLSã€gRPC è¿æ¥ã€æœåŠ¡å‘ç°ï¼ˆç®€åŒ–å®ç°ï¼‰
5. âœ… Phase 1.1 ä¼ è¾“æ¨¡å—ï¼šgRPC åŒå‘æµã€æ•°æ®å‘é€æ¥æ”¶ã€é…ç½®æ›´æ–°å¤„ç†
6. âœ… Phase 1.1 å¿ƒè·³æ¨¡å—ï¼šå®šæ—¶å¿ƒè·³ã€çŠ¶æ€é‡‡é›†ã€ä¸»æœºä¿¡æ¯é‡‡é›†ï¼ˆå·²å®Œæˆï¼šOSã€å†…æ ¸ã€IPã€ä¸»æœºåï¼‰ã€æ’ä»¶çŠ¶æ€é‡‡é›†
7. âœ… Phase 1.1 æ’ä»¶ç®¡ç†æ¨¡å—ï¼šæ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€Pipe é€šä¿¡ã€é…ç½®åŒæ­¥ã€æ’ä»¶ä¸‹è½½å’Œ SHA256 éªŒè¯ã€ä»»åŠ¡é˜Ÿåˆ—å®ç°
8. âœ… Phase 1.1 Baseline Pluginï¼šæ’ä»¶å…¥å£ã€ç­–ç•¥åŠ è½½è§£æã€OS åŒ¹é…ã€è§„åˆ™æ‰§è¡Œæ¡†æ¶ã€æ£€æŸ¥å™¨ï¼ˆfile_kvã€file_permissionã€file_line_matchã€command_execã€sysctlã€service_statusï¼‰ã€ç»“æœä¸ŠæŠ¥
9. âœ… Phase 1.1 æµ‹è¯•ï¼šBaseline Plugin å•å…ƒæµ‹è¯•ï¼ˆæ‰€æœ‰æ£€æŸ¥å™¨æµ‹è¯•é€šè¿‡ï¼Œä»£ç è´¨é‡è‰¯å¥½ï¼‰
10. âœ… Phase 1.2.1ï¼šæ•°æ®åº“æ¨¡å‹è®¾è®¡ï¼ˆHostã€Policyã€Ruleã€ScanResultã€ScanTaskï¼‰
11. âœ… Phase 1.2.2 AgentCenter åŸºç¡€æ¡†æ¶ï¼šä¸»ç¨‹åºã€é…ç½®åŠ è½½ã€æ—¥å¿—åˆå§‹åŒ–ã€æ•°æ®åº“è¿æ¥ã€gRPC Serverã€mTLS é…ç½®
12. âœ… Phase 1.2.2 AgentCenter Transfer æœåŠ¡ï¼šåŒå‘æµã€è¿æ¥ç®¡ç†ã€å¿ƒè·³æ•°æ®å¤„ç†ã€æ£€æµ‹ç»“æœå¤„ç†

**ä¸‹ä¸€æ­¥**ï¼š
1. âœ… Phase 1.1 ç»§ç»­ï¼šå®Œå–„ Baseline Pluginï¼ˆfile_line_matchã€sysctlã€service_status æ£€æŸ¥å™¨ï¼‰- å·²å®Œæˆ
2. âœ… Phase 1.1 ç»§ç»­ï¼šå®Œå–„æ’ä»¶ç®¡ç†ï¼ˆæ’ä»¶ä¸‹è½½å’Œç­¾åéªŒè¯ã€ä»»åŠ¡é˜Ÿåˆ—ï¼‰- å·²å®Œæˆ
3. âœ… Phase 1.1 ç»§ç»­ï¼šæ’ä»¶çŠ¶æ€é‡‡é›†ï¼ˆå¿ƒè·³æ¨¡å—ï¼‰- å·²å®Œæˆ
4. âœ… Phase 1.1 ç»§ç»­ï¼šç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆBaseline Plugin æ£€æŸ¥å™¨æµ‹è¯•ï¼‰- å·²å®Œæˆï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡
5. âœ… Phase 1.1 ç»§ç»­ï¼šå®ç°æ›´å¤šæ£€æŸ¥å™¨ï¼ˆfile_ownerã€package_installedï¼‰- å·²å®Œæˆ
6. ğŸ”„ Phase 1.1 ç»§ç»­ï¼šBaseline Plugin ç¤ºä¾‹è§„åˆ™ï¼ˆSSHã€å¯†ç ç­–ç•¥ç­‰ï¼‰- å¯é€‰ï¼Œåç»­æ‰©å±•
7. âœ… **Phase 1.2 AgentCenter åŸºç¡€æ¡†æ¶** - å·²å®Œæˆ
8. âœ… **Phase 1.2 ç»§ç»­ï¼šå®Œå–„ AgentCenterï¼ˆä»»åŠ¡ä¸‹å‘é€»è¾‘ï¼‰** - å·²å®Œæˆ
9. âœ… **Phase 1.2 å¼€å§‹ï¼šå¼€å‘ Manager HTTP API Server** - åŸºç¡€æ¡†æ¶å·²å®Œæˆ
10. âœ… **Phase 1.2 ç»§ç»­ï¼šå®Œå–„ Manager APIï¼ˆpoliciesã€tasksã€results APIï¼‰** - å·²å®Œæˆ
11. âœ… **Phase 1.2 ç»§ç»­ï¼šå®ç°åŸºçº¿å¾—åˆ†è®¡ç®—å’Œç¼“å­˜** - å·²å®Œæˆ
12. âœ… **Phase 1.2 ç»§ç»­ï¼šå®ç°ä»»åŠ¡çŠ¶æ€è‡ªåŠ¨æ›´æ–°æœºåˆ¶** - å·²å®Œæˆ
13. âœ… **Phase 1.2 ç»§ç»­ï¼šä¼˜åŒ–é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘** - å·²å®Œæˆ
14. âœ… **Phase 1.2 ç»§ç»­ï¼šç¼–å†™é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•** - å·²å®Œæˆï¼ˆä½¿ç”¨ MySQLï¼‰
15. âœ… **Phase 1.3 UI å¼€å‘ï¼šåˆ›å»ºå‰ç«¯é¡¹ç›®åŸºç¡€ç»“æ„** - å·²å®Œæˆï¼ˆVue3 + TypeScript + Pinia + Ant Design Vueï¼‰
16. âœ… **Phase 1.3 UI å¼€å‘ï¼šå®ç° API å®¢æˆ·ç«¯å°è£…** - å·²å®Œæˆ
17. âœ… **Phase 1.3 UI å¼€å‘ï¼šå®ç°ä¸»æœºåˆ—è¡¨å’Œè¯¦æƒ…é¡µé¢** - å·²å®Œæˆ
18. âœ… **Phase 1.3 UI å¼€å‘ï¼šå®ç°ç­–ç•¥ç®¡ç†é¡µé¢** - å·²å®Œæˆ
19. âœ… **Phase 1.3 UI å¼€å‘ï¼šå®ç°æ‰«æä»»åŠ¡ç®¡ç†é¡µé¢** - å·²å®Œæˆ
20. âœ… **Phase 1.3 UI å¼€å‘ï¼šå®ç°ç­–ç•¥è¯¦æƒ…é¡µé¢** - å·²å®Œæˆï¼šæ£€æŸ¥æ¦‚è§ˆã€æ£€æŸ¥é¡¹è§†è§’ã€å½±å“çš„ä¸»æœºåˆ—è¡¨ã€ç­–ç•¥ç»Ÿè®¡ APIï¼ˆåç«¯å·²å®ç° `GET /api/v1/policies/:policy_id/statistics`ï¼‰

**ä¼˜å…ˆçº§**ï¼š
- **P0ï¼ˆå¿…é¡»ï¼‰**ï¼šAgent åŸºç¡€æ¡†æ¶ã€æ’ä»¶ SDKã€Baseline Pluginã€AgentCenterã€æ•°æ®åº“æ¨¡å‹
- **P1ï¼ˆé‡è¦ï¼‰**ï¼šè¿æ¥ç®¡ç†ã€ä¼ è¾“æ¨¡å—ã€Manager APIã€æ£€æµ‹ç»“æœå­˜å‚¨
- **P2ï¼ˆå¯é€‰ï¼‰**ï¼šCollector Pluginã€ServiceDiscoveryã€å‰ç«¯ UIã€èµ„äº§æ•°æ®å­˜å‚¨

---

## å·²çŸ¥é—®é¢˜ï¼ˆå¾…ä¿®å¤ï¼‰

### API æ¥å£é—®é¢˜

#### 1. POST /api/v1/policies åˆ›å»ºç­–ç•¥æ¥å£å¤±è´¥ï¼ˆHTTP 400ï¼‰âœ… å·²ä¿®å¤

**é—®é¢˜æè¿°**ï¼š
- åœ¨ API æµ‹è¯•ä¸­å‘ç° `POST /api/v1/policies` æ¥å£è¿”å› HTTP 400 é”™è¯¯
- æµ‹è¯•æ—¶é—´ï¼š2025-12-11
- æµ‹è¯•åœºæ™¯ï¼šåˆ›å»ºæ–°ç­–ç•¥æ—¶å¤±è´¥
- æ ¹æœ¬åŸå› ï¼š`RuleData` ç»“æ„ä½“ä¸­çš„ `CheckConfig` å­—æ®µæœ‰ `binding:"required"` æ ‡è®°ï¼Œå¯¼è‡´ç¼ºå°‘è¯¥å­—æ®µæ—¶è¯·æ±‚ä½“éªŒè¯å¤±è´¥

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
- âœ… [x] ç§»é™¤ `CheckConfig` çš„ `binding:"required"` æ ‡è®°ï¼ˆæ”¹ä¸ºå¯é€‰å­—æ®µï¼‰
- âœ… [x] åœ¨ `CreatePolicy` æ–¹æ³•ä¸­æ·»åŠ æ‰‹åŠ¨çš„å­—æ®µéªŒè¯ï¼Œç¡®ä¿è§„åˆ™çš„ `RuleID` å’Œ `Title` å¿…å¡«
- âœ… [x] æ·»åŠ äº†æµ‹è¯•ç”¨ä¾‹ `TestCreatePolicyAPI_ValidRequest` å’Œ `TestCreatePolicyAPI_NoCheckConfig`
- âœ… [x] ä¿®å¤åç¼–è¯‘é€šè¿‡ï¼Œæµ‹è¯•éªŒè¯æˆåŠŸ

**ä¿®å¤æäº¤**ï¼š
- æ–‡ä»¶ï¼š`internal/server/manager/api/policies.go`ï¼ˆç¬¬ 140 è¡Œç§»é™¤ binding æ ‡è®°ï¼Œç¬¬ 156-184 è¡Œæ·»åŠ éªŒè¯é€»è¾‘ï¼‰
- æµ‹è¯•ï¼š`internal/server/manager/api/integration_test.go`ï¼ˆæ·»åŠ æ–°æµ‹è¯•å‡½æ•°ï¼‰
- ä¿®å¤æ—¶é—´ï¼š2025-12-11 18:45

---

#### 2. POST /api/v1/tasks/:task_id/run è¿è¡Œä»»åŠ¡æ¥å£å¤±è´¥ï¼ˆHTTP 400ï¼‰âœ… å·²ä¿®å¤

**é—®é¢˜æè¿°**ï¼š
- åœ¨ API æµ‹è¯•ä¸­å‘ç° `POST /api/v1/tasks/:task_id/run` æ¥å£è¿”å› HTTP 400 é”™è¯¯
- æµ‹è¯•æ—¶é—´ï¼š2025-12-11
- æµ‹è¯•åœºæ™¯ï¼šå°è¯•è¿è¡Œä¸€ä¸ªå·²ç»æ˜¯ `running` çŠ¶æ€çš„ä»»åŠ¡æ—¶å¤±è´¥
- æ ¹æœ¬åŸå› ï¼šå½“ä»»åŠ¡å·²åœ¨è¿è¡Œä¸­æ—¶ï¼ŒAPI è¿”å› HTTP 400ï¼Œè¿™åœ¨ RESTful è¯­ä¹‰ä¸Šä¸æ­£ç¡®ï¼Œåº”è¯¥è¿”å› HTTP 409 Conflict

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
- âœ… [x] å°†ä»»åŠ¡å·²åœ¨è¿è¡Œä¸­æ—¶çš„å“åº”çŠ¶æ€ç ä» `400` æ”¹ä¸º `409 Conflict`ï¼ˆç¬¬ 264 è¡Œï¼‰
- âœ… [x] æ”¹è¿›é”™è¯¯æ¶ˆæ¯ä¸º"ä»»åŠ¡æ­£åœ¨æ‰§è¡Œä¸­ï¼Œæ— æ³•é‡å¤æ‰§è¡Œ"ï¼ˆç¬¬ 266 è¡Œï¼‰
- âœ… [x] æ·»åŠ äº†æµ‹è¯•ç”¨ä¾‹ `TestRunTaskAPI_Running` å’Œ `TestRunTaskAPI_Success`
- âœ… [x] ä¿®å¤åç¼–è¯‘é€šè¿‡ï¼Œæµ‹è¯•éªŒè¯æˆåŠŸ

**ä¿®å¤æäº¤**ï¼š
- æ–‡ä»¶ï¼š`internal/server/manager/api/tasks.go`ï¼ˆç¬¬ 264-267 è¡Œä¿®æ”¹ï¼‰
- æµ‹è¯•ï¼š`internal/server/manager/api/integration_test.go`ï¼ˆæ·»åŠ æ–°æµ‹è¯•å‡½æ•°ï¼‰
- ä¿®å¤æ—¶é—´ï¼š2025-12-11 18:45

---

## Server ç«¯å¼€å‘è¯¦ç»†ä»»åŠ¡åˆ†è§£

> **å½“å‰é‡ç‚¹**ï¼šPhase 1.2 Server å¼€å‘ + API ä¿®å¤

### ä»»åŠ¡ 1ï¼šæ•°æ®åº“æ¨¡å‹è®¾è®¡ï¼ˆä¼˜å…ˆçº§ï¼šP0ï¼‰âœ…

**ç›®æ ‡**ï¼šå®šä¹‰å¹¶å®ç°æ‰€æœ‰æ•°æ®åº“è¡¨ç»“æ„ï¼Œæ”¯æŒä¸»æœºç®¡ç†ã€ç­–ç•¥ç®¡ç†ã€æ£€æµ‹ç»“æœå­˜å‚¨ã€‚

**æ­¥éª¤**ï¼š
1. âœ… åˆ›å»º `internal/server/model/` ç›®å½•
2. âœ… å®šä¹‰ Gorm æ¨¡å‹ï¼š
   - âœ… `Host` æ¨¡å‹ï¼ˆhosts è¡¨ï¼‰
   - âœ… `Policy` æ¨¡å‹ï¼ˆpolicies è¡¨ï¼‰
   - âœ… `Rule` æ¨¡å‹ï¼ˆrules è¡¨ï¼‰
   - âœ… `ScanResult` æ¨¡å‹ï¼ˆscan_results è¡¨ï¼‰
   - âœ… `ScanTask` æ¨¡å‹ï¼ˆscan_tasks è¡¨ï¼‰
3. âœ… ç¼–å†™æ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆ`internal/server/migration/`ï¼‰
4. âœ… åˆ›å»ºåˆå§‹åŒ–æ•°æ®è„šæœ¬ï¼ˆé»˜è®¤ç­–ç•¥ã€ç¤ºä¾‹è§„åˆ™ï¼‰

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

---

### ä»»åŠ¡ 2ï¼šAgentCenter åŸºç¡€æ¡†æ¶ï¼ˆä¼˜å…ˆçº§ï¼šP0ï¼‰âœ…

**ç›®æ ‡**ï¼šå®ç° AgentCenter ä¸»ç¨‹åºï¼Œæ”¯æŒ gRPC Server å¯åŠ¨ã€é…ç½®åŠ è½½ã€æ•°æ®åº“è¿æ¥ã€‚

**æ­¥éª¤**ï¼š
1. âœ… åˆ›å»º `cmd/server/agentcenter/main.go`
2. âœ… å®ç°é…ç½®åŠ è½½ï¼ˆViper + YAMLï¼‰
3. âœ… å®ç°æ—¥å¿—åˆå§‹åŒ–ï¼ˆZapï¼ŒJSON è¾“å‡ºï¼‰
4. âœ… å®ç°æ•°æ®åº“è¿æ¥ï¼ˆGormï¼‰
5. âœ… å®ç° gRPC Server å¯åŠ¨
6. âœ… å®ç° mTLS é…ç½®ï¼ˆè¯ä¹¦åŠ è½½ï¼‰
7. âœ… åˆ›å»º `configs/server.yaml.example` é…ç½®æ–‡ä»¶

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

---

### ä»»åŠ¡ 3ï¼šAgentCenter Transfer æœåŠ¡ï¼ˆä¼˜å…ˆçº§ï¼šP0ï¼‰ğŸ”„

**ç›®æ ‡**ï¼šå®ç° `Transfer` åŒå‘æµæœåŠ¡ï¼Œæ¥æ”¶ Agent æ•°æ®å¹¶ä¸‹å‘ä»»åŠ¡ã€‚

**æ­¥éª¤**ï¼š
1. âœ… å®ç° `Transfer` æœåŠ¡æ¥å£ï¼ˆ`internal/server/agentcenter/transfer/service.go`ï¼‰
2. âœ… å®ç°è¿æ¥çŠ¶æ€ç®¡ç†ï¼ˆMap[agent_id]*Connectionï¼‰
3. âœ… å®ç°æ•°æ®æ¥æ”¶é€»è¾‘ï¼š
   - âœ… è§£æ `PackagedData` å’Œ `EncodedRecord`
   - âœ… æ ¹æ® `data_type` è·¯ç”±åˆ°å¤„ç†å™¨
   - âœ… å¿ƒè·³æ•°æ®å¤„ç†ï¼ˆæ›´æ–° hosts è¡¨ï¼‰
   - âœ… æ£€æµ‹ç»“æœå¤„ç†ï¼ˆæ’å…¥ scan_results è¡¨ï¼‰
4. âœ… å®ç°ä»»åŠ¡ä¸‹å‘é€»è¾‘ï¼š
   - [x] æŸ¥è¯¢å¾…æ‰§è¡Œä»»åŠ¡ï¼ˆ`internal/server/agentcenter/service/task.go`ï¼‰
   - [x] å°è£…ä¸º `Command` å¹¶å‘é€
   - [x] ä»»åŠ¡è°ƒåº¦å™¨ï¼ˆæ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡å¾…æ‰§è¡Œä»»åŠ¡ï¼‰
5. âœ… å®ç°è¿æ¥æ–­å¼€å¤„ç†

**å®Œæˆæƒ…å†µ**ï¼šæ•°æ®æ¥æ”¶å’Œä»»åŠ¡ä¸‹å‘åŠŸèƒ½å·²å®Œæˆ

**é¢å¤–å®Œæˆ**ï¼š
- âœ… å®ç°ç­–ç•¥å’Œè§„åˆ™ç®¡ç†æœåŠ¡ï¼ˆ`internal/server/agentcenter/service/policy.go`ï¼‰
  - âœ… ç­–ç•¥ CRUD æ“ä½œ
  - âœ… è§„åˆ™ CRUD æ“ä½œ
  - âœ… æ ¹æ®ä¸»æœºä¿¡æ¯æŸ¥è¯¢é€‚ç”¨ç­–ç•¥

---

### ä»»åŠ¡ 4ï¼šManager åŸºç¡€æ¡†æ¶ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰âœ…

**ç›®æ ‡**ï¼šå®ç° Manager HTTP API Serverï¼Œæ”¯æŒåŸºç¡€ API æ¥å£ã€‚

**æ­¥éª¤**ï¼š
1. âœ… åˆ›å»º `cmd/server/manager/main.go`
2. âœ… å®ç°é…ç½®åŠ è½½å’Œæ—¥å¿—åˆå§‹åŒ–
3. âœ… å®ç° HTTP Serverï¼ˆGinï¼‰
4. âœ… å®ç°ä¸­é—´ä»¶ï¼ˆCORSã€æ—¥å¿—ã€Recoveryï¼‰
5. âœ… å®ç°åŸºç¡€ API è·¯ç”±ï¼ˆhosts APIï¼‰

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

---

### ä»»åŠ¡ 5ï¼šManager API å®ç°ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰âœ…

**ç›®æ ‡**ï¼šå®ç°æ‰€æœ‰ HTTP API æ¥å£ï¼Œæ”¯æŒä¸»æœºç®¡ç†ã€ç­–ç•¥ç®¡ç†ã€ä»»åŠ¡ç®¡ç†ã€ç»“æœæŸ¥è¯¢ã€‚

**æ­¥éª¤**ï¼š
1. âœ… å®ç°ä¸»æœºç®¡ç† APIï¼ˆ`internal/server/manager/api/hosts.go`ï¼‰
   - âœ… `GET /api/v1/hosts`
   - âœ… `GET /api/v1/hosts/{host_id}`
2. âœ… å®ç°ç­–ç•¥ç®¡ç† APIï¼ˆ`internal/server/manager/api/policies.go`ï¼‰
   - âœ… `GET /api/v1/policies`
   - âœ… `POST /api/v1/policies`
   - âœ… `PUT /api/v1/policies/{policy_id}`
   - âœ… `DELETE /api/v1/policies/{policy_id}`
3. âœ… å®ç°ä»»åŠ¡ç®¡ç† APIï¼ˆ`internal/server/manager/api/tasks.go`ï¼‰
   - âœ… `POST /api/v1/tasks`
   - âœ… `GET /api/v1/tasks`
   - âœ… `POST /api/v1/tasks/{task_id}/run`
4. âœ… å®ç°ç»“æœæŸ¥è¯¢ APIï¼ˆ`internal/server/manager/api/results.go`ï¼‰
   - âœ… `GET /api/v1/results`
   - âœ… `GET /api/v1/results/host/{host_id}/score`
   - âœ… `GET /api/v1/results/host/{host_id}/summary`
5. âœ… å®ç°ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆ`internal/server/manager/biz/score.go`ï¼‰- åŸºçº¿å¾—åˆ†è®¡ç®—å’Œç¼“å­˜

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

**é¢å¤–å®Œæˆ**ï¼š
- âœ… å®ç°åŸºçº¿å¾—åˆ†è®¡ç®—å’Œç¼“å­˜æœºåˆ¶
- âœ… å®ç°ä»»åŠ¡çŠ¶æ€è‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼ˆ`internal/server/agentcenter/service/task_status.go`ï¼‰

---

### ä»£ç ç»“æ„é‡æ„ï¼ˆä¼˜å…ˆçº§ï¼šP2ï¼‰âœ…

**ç›®æ ‡**ï¼šä¼˜åŒ–ä»£ç ç»“æ„ï¼Œéµå¾ªæœ€ä½³å®è·µï¼Œä½¿ main.go æ›´ç®€æ´ï¼Œè·¯ç”±å’Œä¸­é—´ä»¶ç‹¬ç«‹ç»´æŠ¤ã€‚

**æ­¥éª¤**ï¼š
1. âœ… é‡æ„ Manager main.go
   - âœ… åˆ›å»º `internal/server/manager/router` åŒ…ï¼Œæå–æ‰€æœ‰è·¯ç”±è®¾ç½®é€»è¾‘
   - âœ… åˆ›å»º `internal/server/manager/middleware` åŒ…ï¼Œæå–ä¸­é—´ä»¶
   - âœ… åˆ›å»º `internal/server/manager/setup` åŒ…ï¼Œæå–æ‰€æœ‰åˆå§‹åŒ–é€»è¾‘
   - âœ… ç®€åŒ– `cmd/server/manager/main.go`ï¼ˆä» 171 è¡Œå‡å°‘åˆ°çº¦ 60 è¡Œï¼‰
2. âœ… é‡æ„ AgentCenter main.go
   - âœ… åˆ›å»º `internal/server/agentcenter/server` åŒ…ï¼Œæå– gRPC Server åˆ›å»ºé€»è¾‘
   - âœ… åˆ›å»º `internal/server/agentcenter/scheduler` åŒ…ï¼Œæå–ä»»åŠ¡è°ƒåº¦å™¨
   - âœ… åˆ›å»º `internal/server/agentcenter/setup` åŒ…ï¼Œæå–æ‰€æœ‰åˆå§‹åŒ–é€»è¾‘
   - âœ… ç®€åŒ– `cmd/server/agentcenter/main.go`ï¼ˆä» 129 è¡Œå‡å°‘åˆ°çº¦ 50 è¡Œï¼‰
3. âœ… éªŒè¯ç¼–è¯‘éš”ç¦»ï¼šç¡®ä¿ agentã€agentcenterã€manager ç‹¬ç«‹ç¼–è¯‘ï¼Œä¸ä¼šç›¸äº’åŒ…å«ä»£ç 

**å®Œæˆæ—¶é—´**ï¼š2024-12-11ï¼ˆé¦–æ¬¡é‡æ„ï¼‰ï¼Œ2024-12-XXï¼ˆåˆå§‹åŒ–é€»è¾‘æå–ï¼‰

**é‡æ„ç»“æœ**ï¼š
- Manager: main.go çº¦ 60 è¡Œï¼Œsetup/init.go çº¦ 144 è¡Œï¼Œrouter.go 219 è¡Œï¼Œmiddleware.go 48 è¡Œ
- AgentCenter: main.go çº¦ 50 è¡Œï¼Œsetup/init.go çº¦ 139 è¡Œï¼Œserver.go 63 è¡Œï¼Œscheduler.go 31 è¡Œ
- ä»£ç ç»“æ„æ›´æ¸…æ™°ï¼Œç¬¦åˆ Go æœ€ä½³å®è·µ
- åˆå§‹åŒ–é€»è¾‘å®Œå…¨ç‹¬ç«‹ï¼Œmain.go åªè´Ÿè´£å¯åŠ¨æµç¨‹å’Œä¿¡å·å¤„ç†
- âœ… å®ç°é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘ï¼ˆ`internal/server/agentcenter/service/retry.go`ï¼‰
- âœ… ç¼–å†™ Manager API é›†æˆæµ‹è¯•ï¼ˆ`internal/server/manager/api/integration_test.go`ï¼‰

---

### ä»»åŠ¡ 6ï¼šè¯ä¹¦ç”Ÿæˆè„šæœ¬ï¼ˆä¼˜å…ˆçº§ï¼šP0ï¼‰âœ…

**ç›®æ ‡**ï¼šæä¾› mTLS è¯ä¹¦ç”Ÿæˆè„šæœ¬ï¼Œæ”¯æŒ Server å’Œ Agent è¯ä¹¦ç”Ÿæˆã€‚

**æ­¥éª¤**ï¼š
1. âœ… åˆ›å»º `scripts/generate-certs.sh`
2. âœ… å®ç° CA è¯ä¹¦ç”Ÿæˆ
3. âœ… å®ç° Server è¯ä¹¦ç”Ÿæˆ
4. âœ… å®ç° Agent è¯ä¹¦ç”Ÿæˆ
5. âœ… ç¼–å†™è¯ä¹¦ä½¿ç”¨è¯´æ˜ï¼ˆè„šæœ¬å†…åŒ…å«ï¼‰

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

---

### ä»»åŠ¡ 7ï¼šé›†æˆæµ‹è¯•ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰âœ…

**ç›®æ ‡**ï¼šå®ç° Agent + Server + Plugin é›†æˆæµ‹è¯•ï¼ŒéªŒè¯å®Œæ•´æµç¨‹ã€‚

**æ­¥éª¤**ï¼š
1. âœ… ç¼–å†™é›†æˆæµ‹è¯•æ¡†æ¶ï¼ˆ`tests/e2e/e2e_test.go`ï¼‰
2. âœ… æµ‹è¯• Agent è¿æ¥ Server
3. âœ… æµ‹è¯•å¿ƒè·³ä¸ŠæŠ¥
4. âœ… æµ‹è¯•ä»»åŠ¡ä¸‹å‘å’Œæ‰§è¡Œ
5. âœ… æµ‹è¯•æ£€æµ‹ç»“æœä¸ŠæŠ¥å’Œå­˜å‚¨
6. âœ… æµ‹è¯•åŸºçº¿å¾—åˆ†è®¡ç®—
7. âœ… ä½¿ç”¨ MySQL æ•°æ®åº“ï¼ˆç¬¦åˆé¡¹ç›®æ ‡å‡†ï¼‰
8. âœ… æ·»åŠ æµ‹è¯•è¿è¡Œè¯´æ˜æ–‡æ¡£ï¼ˆ`tests/e2e/README.md`ï¼‰

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

**è¯´æ˜**ï¼š
- E2E æµ‹è¯•ä½¿ç”¨ MySQL æ•°æ®åº“ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼‰
- æµ‹è¯•è¦†ç›–äº†å®Œæ•´çš„ Agent + Server + Plugin æµç¨‹
- åŒ…å«æµ‹è¯•è¿è¡Œè¯´æ˜æ–‡æ¡£

---

**æ€»è®¡é¢„è®¡æ—¶é—´**ï¼š10-15 å¤©

---

### ä»»åŠ¡ 8ï¼šUI æ”¹è¿›å’Œåç«¯ API å®ç°ï¼ˆä¼˜å…ˆçº§ï¼šP1ï¼‰âœ…

**ç›®æ ‡**ï¼šåŸºäº Elkeid å‚è€ƒå®ç°å®Œæ•´çš„ UI ç•Œé¢å’Œåç«¯ API æ”¯æŒã€‚

**æ­¥éª¤**ï¼š
1. âœ… å®ç°ç™»å½•ç•Œé¢å’Œå®‰å…¨è®¤è¯
   - âœ… å‰ç«¯ç™»å½•é¡µé¢ï¼ˆ`ui/src/views/Login.vue`ï¼‰
   - âœ… è®¤è¯çŠ¶æ€ç®¡ç†ï¼ˆPinia storeï¼‰
   - âœ… è·¯ç”±å®ˆå«
   - âœ… åç«¯è®¤è¯ APIï¼ˆ`internal/server/manager/api/auth.go`ï¼‰
   - âœ… JWT Token è®¤è¯æœºåˆ¶
2. âœ… å®ç° Dashboard é¡µé¢
   - âœ… Dashboard å‰ç«¯é¡µé¢ï¼ˆå‚è€ƒ console0.pngï¼‰
   - âœ… Dashboard ç»Ÿè®¡ APIï¼ˆ`internal/server/manager/api/dashboard.go`ï¼‰
3. âœ… æ”¹è¿› Layout å¸ƒå±€
   - âœ… å·¦ä¾§å¯¼èˆªæ ï¼ˆå‚è€ƒ Elkeid æ ·å¼ï¼‰
   - âœ… é¡¶éƒ¨æ ï¼ˆç”¨æˆ·ä¿¡æ¯å’Œé€€å‡ºç™»å½•ï¼‰
4. âœ… æ”¹è¿›ä¸»æœºè¯¦æƒ…é¡µ
   - âœ… å¤šæ ‡ç­¾é¡µå®ç°ï¼ˆå‚è€ƒ console3.pngï¼‰
   - âœ… ä¸»æœºæ¦‚è§ˆç»„ä»¶ï¼ˆåŸºæœ¬ä¿¡æ¯ã€å®‰å…¨å‘Šè­¦ã€æ¼æ´é£é™©ã€åŸºçº¿é£é™©ã€èµ„äº§æŒ‡çº¹ï¼‰
   - âœ… åŸºçº¿é£é™©ç»„ä»¶
5. âœ… æ”¹è¿›åŸºçº¿æ£€æŸ¥è¯¦æƒ…é¡µ
   - âœ… æ£€æŸ¥æ¦‚è§ˆï¼ˆé€šè¿‡ç‡ã€ä¸»æœºæ•°ã€æ£€æŸ¥é¡¹æ•°ï¼‰
   - âœ… æ£€æŸ¥é¡¹è§†è§’ï¼ˆæ£€æŸ¥é¡¹åˆ—è¡¨å’Œè¯¦æƒ…ï¼‰
   - âœ… å½±å“çš„ä¸»æœºåˆ—è¡¨ï¼ˆæ˜¾ç¤ºå—å½±å“çš„ä¸»æœºåŠå…¶æ£€æŸ¥ç»“æœï¼‰
   - âœ… ç­–ç•¥ç»Ÿè®¡ APIï¼ˆ`internal/server/manager/api/policies.go` - `GetPolicyStatistics`ï¼‰
6. âœ… æ›´æ–°æ–‡æ¡£
   - âœ… UI æ”¹è¿›éœ€æ±‚æ–‡æ¡£ï¼ˆ`docs/features/ui-improvements.md`ï¼‰
   - âœ… Server API æ–‡æ¡£æ›´æ–°ï¼ˆæ·»åŠ è®¤è¯ã€Dashboardã€ç­–ç•¥ç»Ÿè®¡ APIï¼‰

**å®Œæˆæ—¶é—´**ï¼šå·²å®Œæˆ

**è¯´æ˜**ï¼š
- æ‰€æœ‰ UI æ”¹è¿›å‚è€ƒ Elkeid æ§åˆ¶å°è®¾è®¡
- å®ç°äº†å®Œæ•´çš„è®¤è¯ç³»ç»Ÿï¼ˆJWT Tokenï¼‰
- Dashboard å’Œä¸»æœºè¯¦æƒ…é¡µå·²å®ç°ä¸»è¦åŠŸèƒ½
- åŸºçº¿æ£€æŸ¥è¯¦æƒ…é¡µï¼ˆç­–ç•¥è¯¦æƒ…é¡µï¼‰å·²å®ç°æ£€æŸ¥é¡¹è§†è§’å’Œå½±å“çš„ä¸»æœºåˆ—è¡¨
- åç«¯ API å·²å®ç°å¹¶é›†æˆåˆ°è·¯ç”±ä¸­ï¼ŒåŒ…æ‹¬ç­–ç•¥ç»Ÿè®¡ APIï¼ˆ`GET /api/v1/policies/:policy_id/statistics`ï¼‰

**å¾…å®ç°åŠŸèƒ½**ï¼š
- ç”¨æˆ·ç®¡ç†ï¼ˆç”¨æˆ·è¡¨ã€è§’è‰²æƒé™ï¼‰
- å‘Šè­¦ç³»ç»Ÿï¼ˆå‘Šè­¦æ•°æ®æ¨¡å‹å’Œç»Ÿè®¡ï¼‰
- æ¼æ´ç®¡ç†ï¼ˆæ¼æ´æ•°æ®æ¨¡å‹å’Œç»Ÿè®¡ï¼‰
- èµ„äº§æŒ‡çº¹è¯¦æƒ…ï¼ˆèµ„äº§æ•°æ®é‡‡é›†å’Œå±•ç¤ºï¼‰
- å›¾è¡¨å±•ç¤ºï¼ˆè¶‹åŠ¿å›¾ï¼‰
- ä¸»æœºè§†è§’ï¼ˆåŸºçº¿æ£€æŸ¥è¯¦æƒ…é¡µçš„å¦ä¸€ä¸ªè§†è§’ï¼‰
- ç«‹å³æ£€æŸ¥åŠŸèƒ½ï¼ˆç­–ç•¥è¯¦æƒ…é¡µçš„"ç«‹å³æ£€æŸ¥"æŒ‰é’®ï¼‰
- æ‰¹é‡é‡æ–°æ£€æŸ¥åŠŸèƒ½
- ç™½åå•åŠŸèƒ½

---

## å‚è€ƒæ–‡æ¡£

### è®¾è®¡æ–‡æ¡£
- [Elkeid æ¶æ„åˆ†æ](./elkeid-notes/elkeid-architecture-analysis.md)
- [Elkeid ç ”ç©¶æ€»ç»“](./elkeid-notes/summary.md)
- [ç­–ç•¥æ¨¡å‹è®¾è®¡](./design/baseline-policy-model.md)
- [Agent æ¶æ„è®¾è®¡](./design/agent-architecture.md)
- [Agent é…ç½®è®¾è®¡](./design/agent-config-design.md)
- [Server API è®¾è®¡](./design/server-api.md)
- [UI æ”¹è¿›éœ€æ±‚æ–‡æ¡£](./features/ui-improvements.md)
- [Agent éƒ¨ç½²æŒ‡å—](../deployment/agent-deployment.md)

### å‚è€ƒä»£ç 
- Elkeid Agentï¼š`Elkeid/agent/`
- Elkeid Baseline Pluginï¼š`Elkeid/plugins/baseline/`
- Elkeid Collector Pluginï¼š`Elkeid/plugins/collector/`
- Elkeid Plugin SDKï¼š`Elkeid/plugins/lib/`
- Elkeid AgentCenterï¼š`Elkeid/server/agent_center/`
- Elkeid Managerï¼š`Elkeid/server/manager/`
- Elkeid ServiceDiscoveryï¼š`Elkeid/server/service_discovery/`

### é¡¹ç›®æ–‡æ¡£
- [é¡¹ç›® README](../README.md)
- [Cursor è§„åˆ™](../.cursor/rules/common.mdc)

